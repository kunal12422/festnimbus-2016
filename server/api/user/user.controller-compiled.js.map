{"version":3,"sources":["user.controller.js"],"names":[],"mappings":"AAAA;;AACA,IAAI,IAAK,QAAQ,QAAR,CAAL;AACJ,IAAI,OAAO,QAAQ,MAAR,CAAP;AACJ,IAAI,OAAM,QAAQ,WAAR,CAAN;;AAEJ,IAAI,OAAO,QAAQ,cAAR,CAAP;AACJ,IAAI,WAAW,QAAQ,UAAR,CAAX;AACJ,IAAI,SAAS,QAAQ,0BAAR,CAAT;AACJ,IAAI,MAAM,QAAQ,cAAR,CAAN;;;;;;;;;;;;AAcJ,QAAQ,KAAR,GAAgB,UAAS,GAAT,EAAc,GAAd,EAAkB;AAChC,MAAI,IAAJ,CAAS;AACR,cAAU,IAAV;AACS,YAAO,SAAP;GAFV,EADgC;CAAlB;;;;;;;;;;;;;;;;;;;;;;AA+Bd,QAAQ,UAAR,GAAqB,UAAS,GAAT,EAAc,GAAd,EAAmB,IAAnB,EAAwB;;AAE7C,OAAK,IAAL,CAAU,EAAC,SAAS,IAAI,IAAJ,CAAS,KAAT,EAApB,EAAqC,UAAS,GAAT,EAAc,IAAd,EAAmB;AACvD,YAAQ,GAAR,CAAY,IAAI,IAAJ,CAAZ,CADuD;AAEtD,QAAG,KAAK,MAAL,EAAc;AACf,UAAI,IAAJ,CAAS,EAAC,WAAW,2BAAX,EAAV,EADe;KAAjB,MAEM;AACJ,UAAI,UAAU,IAAI,IAAJ,CAAS,IAAI,IAAJ,CAAnB,CADA;AAEJ,cAAQ,QAAR,GAAmB,OAAnB,CAFI;AAGJ,cAAQ,IAAR,GAAe,MAAf,CAHI;AAIJ,cAAQ,MAAR,GAAe,KAAK,EAAL,EAAf,CAJI;AAKJ,cAAQ,IAAR,CAAa,UAAS,GAAT,EAAc,IAAd,EAAmB;;AAE9B,YAAG,GAAH,EAAQ,OAAO,KAAK,GAAL,CAAP,CAAR;;;AAF8B,WAK9B,CAAI,IAAJ,CAAS;AACd,oBAAU,cAAV;AACQ,kBAAO,yBAAP;SAFH;;AAL8B,WAU9B,CAAI,MAAJ,GAAa,KAAK,GAAL,CAViB;AAW9B,gBAAQ,GAAR,CAAY,KAAZ,EAX8B;AAY9B,eAZ8B;OAAnB,CAAb,CALI;KAFN;GAFmC,CAArC,CAF6C;CAAxB;;AAiCvB,QAAQ,OAAR,GAAkB,UAAS,GAAT,EAAc,GAAd,EAAmB,IAAnB,EAAwB;AACxC,MAAI,SAAS,IAAI,IAAJ,CAAS,GAAT,CAD2B;AAExC,OAAK,OAAL,CAAa;AACX,SAAK,MAAL;GADF,EAEG,uBAFH,EAE4B,UAAS,GAAT,EAAc,IAAd,EAAoB;;AAC9C,QAAI,GAAJ,EAAS,OAAO,KAAK,GAAL,CAAP,CAAT;AACA,QAAI,CAAC,IAAD,EAAO,OAAO,IAAI,IAAJ,CAAS,GAAT,CAAP,CAAX;;AAEA,QAAI,OAAO;AACT,gBAAS,IAAT;AACA,YAAK,KAAK,OAAL;KAFH,CAJ0C;AAQ9C,QAAI,SAAJ,CAAc,eAAd,EAA+B,uBAA/B,EAR8C;;AAU9C,QAAI,IAAJ,CAAS,IAAT,EAV8C;GAApB,CAF5B,CAFwC;CAAxB;;AA0BlB,QAAQ,WAAR,GAAqB,UAAS,GAAT,EAAa,GAAb,EAAiB,IAAjB,EAAsB;AACzC,OAAK,IAAL,CAAU,EAAV,EACG,IADH,CACQ,EAAE,cAAc,CAAC,CAAD,EADxB,EAEG,MAFH,CAEU,EAAC,QAAQ,CAAR,EAAU,kBAAiB,CAAjB,EAAmB,OAAM,CAAN,EAAQ,UAAS,CAAT,EAAW,YAAW,CAAX,EAAa,MAAK,CAAL,EAFxE,EAGG,IAHH,CAGQ,UAAS,GAAT,EAAa,IAAb,EAAmB;AACzB,QAAI,GAAJ,EAAS,OAAO,KAAK,GAAL,CAAP,CAAT;AACA,QAAI,OAAM;AACZ,YAAK,IAAL;KADM,CAFqB;;AAMzB,QAAI,IAAJ,CAAS,IAAT,EANyB;GAAnB,CAHR,CADyC;CAAtB","file":"user.controller-compiled.js","sourcesContent":["'use strict';\nvar _ =  require('lodash');\nvar path = require('path');\nvar uuid =require('node-uuid');\n\nvar User = require('./user.model');\nvar passport = require('passport');\nvar config = require('../../config/environment');\nvar jwt = require('jsonwebtoken');\n//var nodemailer = require('nodemailer');\n//var sgTransport = require('nodemailer-sendgrid-transport');\n//var set = require('Set');\n//var redis = require(\"redis\");\n //var lb =require(\"redis-leaderboard\");\n//var lb =require('leaderboard');\n\n//arr = new Array(10000);\n//count = new Array(10000);\n//never = new Array(10000);\n\n\n\nexports.index = function(req, res){\n  res.json({\n\t  'status': 'OK',\n            'data':'working'\n  });\n\n};\n\n\n/*\nvar host,link,mailOptions;\nvar smtpTransport = nodemailer.createTransport(\"SMTP\",{\n  service: \"Gmail\",\n  auth: {\n    user: \"dcrboy7@gmail.com\",\n    pass: \"icanmakeit\"\n  }\n});\n*/\n/*\nvar transporter = nodemailer.createTransport({\n  service: 'SendGrid',\n  auth: {\n    user: 'sandydcr',\n    pass: 'lov.A123'\n  }\n});\n*/\n\n\n\n  exports.createUser = function(req, res, next){\n\t  \n  User.find({'email': req.body.email}, function(err, user){\n\t  console.log(req.body);\n    if(user.length)  {\n      res.json({'message': 'users email already exist'});\n    }else {\n      var newUser = new User(req.body);\n      newUser.provider = 'local';\n      newUser.role = 'user';\n      newUser.unique=uuid.v4();\n      newUser.save(function(err, user){\n       // console.log(process.env.SESSION_SECRET);\n        if(err) return next(err);\n       // var token = jwt.sign({_id: user._id},'sandy', { expiresIn: 1200 });\n\n        res.json({\n\t\t\t'status': 'User Created',\n           'data':'Registered Successfully'\n           });\n        //store userId on request for next middleware\n        res.userId = user._id;\n        console.log('dcr');\n        next();\n      });\n    }\n\n  });\n\n};\n\n\n\nexports.profile = function(req, res, next){\n  var userId = req.user._id;\n  User.findOne({\n    _id: userId\n  }, '-salt -hashedPassword', function(err, user) { // don't give out the password or salt\n    if (err) return next(err);\n    if (!user) return res.json(401);\n\n    var body = {\n      'status':'ok',\n      data:user.profile \n      };\n    res.setHeader('Cache-Control', 'public, max-age=86400');\n  \n    res.json(body);\n  })\n};\n\n\n\n\n\n\n\n\n\nexports.leaderboard= function(req,res,next){\n  User.find({})\n    .sort({ \"gold_coins\": -1 })\n    .select({'salt': 0,'hashedPassword':0,'_id':0,'unique':0,'verified':0,'_v':0})\n    .exec(function(err,User) {\n    if (err) return next(err);\n    var body ={\n\t\tdata:User\n\t\t};\n\n    res.json(body);\n  });\n};\n\n\n\n\n\n/*\nexports.make_array = function(req,res,next){\n  user.find({},function(err,query){\n    for (var i=0; i<arr.length;i++)\n      arr[i]=0;\n    for( i=0;i<never.length;i++)\n      never[i]=0;\n     i=0;\n\n    query.forEach(function(d){\n       arr[i] = d.gold_coins;\n      if(count[d.gold_coins]==0){\n        never[d.gold_coins]= d.email;\n        count[d.gold_coins]++;\n      }\n      else\n      {\n\n      }\n\n      i++;\n    })\n  })\n};\n*/\n\n\n\n"]}